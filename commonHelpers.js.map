{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com';\n\nexport const fetchImageData = async (\n  serachRequest,\n  { pageCounter, per_page }\n) => {\n  const searchParams = {\n    key: '20858658-55430aeeed6a37ac1f56d3c0c',\n    q: serachRequest,\n    page: pageCounter,\n    per_page,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n  };\n\n  const response = await axios('/api/', {\n    params: searchParams,\n  });\n\n  if (response.status === 'error') {\n    throw new Error(response.code);\n  }\n\n  return response.data;\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst buttonLoadMore = document.querySelector('.load-more-button');\nconst gallery = document.querySelector('.gallery-list');\n\n// Function: show notification\nexport function showNotification(msg) {\n  iziToast.settings({\n    timeout: 5000,\n    titleColor: '#fff',\n    position: 'topRight',\n    messageColor: '#fff',\n    icon: '',\n    close: false,\n  });\n\n  iziToast.error({\n    message: msg,\n    class: 'error-notification',\n    timeout: 5000,\n    iconUrl: './img/octagon.svg',\n    titleColor: '#fff',\n    position: 'topRight',\n    backgroundColor: '#EF4040',\n    messageColor: '#fff',\n    progressBarColor: '#B51B1B',\n    close: true,\n  });\n}\n\n// Create markup from array\nexport function createMarkup(array) {\n  return array\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"image-card\">\n              <a href=\"${largeImageURL}\" class=\"image-card-link\"><img src=\"${webformatURL}\" width=\"360\" height=\"200\" class=\"image-card-thumb\" alt=\"${tags}\">\n                <ul class=\"image-card-details-list\">\n                  <li class=\"image-card-details-list-item\">\n                      <p class=\"image-card-details-title\">Likes</p>\n                      <p class=\"image-card-details-text\">${likes}</p>\n                  </li>\n                  <li class=\"image-card-details-list-item\">\n                      <p class=\"image-card-details-title\">Views</p>\n                      <p class=\"image-card-details-text\">${views}</p>\n                  </li>\n                  <li class=\"image-card-details-list-item\">\n                      <p class=\"image-card-details-title\">Comments</p>\n                      <p class=\"image-card-details-text\">${comments}</p>\n                  </li>\n                  <li class=\"image-card-details-list-item\">\n                      <p class=\"image-card-details-title\">Downloads</p>\n                      <p class=\"image-card-details-text\">${downloads}</p>\n                  </li>\n                </ul>\n              </a>\n          </li>`;\n      }\n    )\n    .join('');\n}\n\n// Update UI\nexport function updateUi(arrayImages) {\n  if (arrayImages.length <= 0) {\n    showNotification(\n      'Sorry, there are no images matching your search query. Please try again!'\n    );\n  }\n  gallery.insertAdjacentHTML('afterbegin', createMarkup(arrayImages));\n}\n\n// Show Loader\nexport function showLoader(status, siblingElement) {\n  const loaderMarkup = '<div class=\"loader\"></div>';\n\n  if (status && !document.querySelector('.loader')) {\n    siblingElement.insertAdjacentHTML('afterend', loaderMarkup);\n  } else {\n    document.querySelector('.loader').remove();\n  }\n}\n\n// Show button load-more\nexport function showLoadMoreButton(status) {\n  if (status) {\n    buttonLoadMore.classList.remove('is-hidden');\n  } else {\n    buttonLoadMore.classList.add('is-hidden');\n  }\n}\n","import './js/pixabay-api';\nimport { fetchImageData } from './js/pixabay-api';\nimport './js/render-functions';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport {\n  updateUi,\n  showLoader,\n  showLoadMoreButton,\n  showNotification,\n  createMarkup,\n} from './js/render-functions';\n\nconst refs = {\n  searchForm: document.querySelector('.search-bar-form'),\n  searchInput: document.querySelector('#search-bar'),\n  searchButton: document.querySelector('button'),\n  loadMoreButton: document.querySelector('.load-more-button'),\n  galleryList: document.querySelector('.gallery-list'),\n};\n\nconst lightbox = new SimpleLightbox('.image-card-link', {\n  caption: true,\n  captionSelector: 'img',\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionDelay: 250,\n  captionPosition: 'bottom',\n});\n\n// Search params\nlet userSearchRequestValue = '';\nconst searchParams = {\n  pageCounter: 1,\n  per_page: 15,\n};\nlet totalPages = 0;\n\n// Add EventListners\nrefs.searchForm.addEventListener('submit', onSearchFormSubmit);\nrefs.loadMoreButton.addEventListener('click', onLoadMoreButtonClick);\nrefs.searchInput.addEventListener('change', onSearchInputChange);\n\n// *** Functions ***\n// When user provide query, set submit button active\nfunction onSearchInputChange(event) {\n  const value = event.target.value.trim();\n  if (value !== '') {\n    refs.searchButton.classList.remove('is-disable');\n  } else {\n    refs.searchButton.classList.add('is-disable');\n  }\n}\n// Submit form to fetch data from server and render result\nasync function onSearchFormSubmit(event) {\n  event.preventDefault();\n  const form = event.currentTarget;\n\n  // Reset page counter and clear result list\n  searchParams.pageCounter = 1;\n  refs.galleryList.innerHTML = '';\n\n  // Get user query from input\n  userSearchRequestValue = event.target.elements.searchQuery.value.trim();\n\n  if (userSearchRequestValue === '') {\n    showNotification('Search query can not be empty!');\n    return;\n  }\n\n  try {\n    showLoader(true, refs.searchForm);\n\n    const { hits, totalHits } = await fetchImageData(\n      userSearchRequestValue,\n      searchParams\n    );\n\n    // Get total pages\n    totalPages = Math.ceil(totalHits / searchParams.per_page);\n\n    // Hide button when rich end of collection\n    if (searchParams.pageCounter >= totalPages) {\n      showLoadMoreButton(false);\n      refs.loadMoreButton.removeEventListener('click', onLoadMoreButtonClick);\n    } else {\n      showLoadMoreButton(true);\n    }\n    // Render images, hide loader, and show load more button\n    updateUi(hits);\n    showLoader(false, refs.searchForm);\n    lightbox.refresh();\n  } catch (error) {\n    showNotification(error.message);\n    showLoader(false, refs.searchForm);\n  }\n\n  // Make submit button disable after form submit\n  refs.searchButton.classList.add('is-disable');\n  form.reset();\n}\n// Load more images when user click \"load more\" button\nasync function onLoadMoreButtonClick() {\n  showLoader(true, refs.loadMoreButton);\n\n  try {\n    searchParams.pageCounter += 1;\n\n    const response = await fetchImageData(userSearchRequestValue, searchParams);\n    const images = response.hits;\n    refs.galleryList.insertAdjacentHTML('beforeend', createMarkup(images));\n    lightbox.refresh();\n\n    // Hide button when rich end of collection\n    if (searchParams.pageCounter >= totalPages) {\n      showLoadMoreButton(false);\n      refs.loadMoreButton.removeEventListener('click', onLoadMoreButtonClick);\n      showNotification(\n        `We're sorry, but you've reached the end of search results.`\n      );\n    }\n\n    // Run smooth scroll function to scroll smooth on top of the list result\n    smoothScroll();\n\n    // Remove loader from DOM\n    showLoader(false, refs.loadMoreButton);\n  } catch (error) {\n    showNotification(error.message);\n  }\n}\n// Smooth Scroll to the top of the result list\nfunction smoothScroll() {\n  const imageCard = refs.galleryList.querySelector(\n    '.image-card-details-list-item'\n  );\n  const imageCardHeight = imageCard.getBoundingClientRect().height;\n  const viewportHeight = window.viewportHeight;\n  const scrollHeight = imageCardHeight * 20;\n  console.log(scrollHeight);\n\n  if (imageCard) {\n    window.scrollBy({\n      top: scrollHeight,\n      left: 0,\n      behavior: 'smooth',\n    });\n  }\n}\n"],"names":["axios","fetchImageData","serachRequest","pageCounter","per_page","response","buttonLoadMore","gallery","showNotification","msg","iziToast","createMarkup","array","webformatURL","largeImageURL","tags","likes","views","comments","downloads","updateUi","arrayImages","showLoader","status","siblingElement","loaderMarkup","showLoadMoreButton","refs","lightbox","SimpleLightbox","userSearchRequestValue","searchParams","totalPages","onSearchFormSubmit","onLoadMoreButtonClick","onSearchInputChange","event","form","hits","totalHits","error","images","smoothScroll","imageCard","scrollHeight"],"mappings":"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"}