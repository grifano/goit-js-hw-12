{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com';\n\nexport const fetchImageData = async (\n  serachRequest,\n  { pageCounter, per_page }\n) => {\n  const searchParams = {\n    key: '20858658-55430aeeed6a37ac1f56d3c0c',\n    q: serachRequest,\n    page: pageCounter,\n    per_page,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n  };\n\n  const response = await axios('/api/', {\n    params: searchParams,\n  });\n\n  if (response.status === 'error') {\n    throw new Error(response.code);\n  }\n\n  return response.data;\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst button = document.querySelector('button');\nconst buttonLoadMore = document.querySelector('.load-more-button');\nconst gallery = document.querySelector('.gallery-list');\n\n// Function addLightbox\nexport function addLightbox() {\n  const lightbox = new SimpleLightbox('.image-card-link', {\n    caption: true,\n    captionSelector: 'img',\n    captionType: 'attr',\n    captionsData: 'alt',\n    captionDelay: 250,\n    captionPosition: 'bottom',\n  });\n  lightbox.refresh();\n}\n\n// Function: show notification\nexport function showNotification(msg) {\n  iziToast.settings({\n    timeout: 5000,\n    titleColor: '#fff',\n    position: 'topRight',\n    messageColor: '#fff',\n    icon: '',\n    close: false,\n  });\n\n  iziToast.error({\n    message: msg,\n    class: 'error-notification',\n    timeout: 5000,\n    iconUrl: '/img/octagon.svg',\n    titleColor: '#fff',\n    position: 'topRight',\n    backgroundColor: '#EF4040',\n    messageColor: '#fff',\n    progressBarColor: '#B51B1B',\n    close: true,\n  });\n}\n\n// Create markup from array\nexport function createMarkup(array) {\n  return array\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"image-card\">\n              <a href=\"${largeImageURL}\" class=\"image-card-link\"><img src=\"${webformatURL}\" width=\"360\" height=\"200\" class=\"image-card-thumb\" alt=\"${tags}\">\n                <ul class=\"image-card-details-list\">\n                  <li class=\"image-card-details-list-item\">\n                      <p class=\"image-card-details-title\">Likes</p>\n                      <p class=\"image-card-details-text\">${likes}</p>\n                  </li>\n                  <li class=\"image-card-details-list-item\">\n                      <p class=\"image-card-details-title\">Views</p>\n                      <p class=\"image-card-details-text\">${views}</p>\n                  </li>\n                  <li class=\"image-card-details-list-item\">\n                      <p class=\"image-card-details-title\">Comments</p>\n                      <p class=\"image-card-details-text\">${comments}</p>\n                  </li>\n                  <li class=\"image-card-details-list-item\">\n                      <p class=\"image-card-details-title\">Downloads</p>\n                      <p class=\"image-card-details-text\">${downloads}</p>\n                  </li>\n                </ul>\n              </a>\n          </li>`;\n      }\n    )\n    .join('');\n}\n\n// Update UI\nexport function updateUi(arrayImages) {\n  if (arrayImages.length <= 0) {\n    showNotification(\n      'Sorry, there are no images matching your search query. Please try again!'\n    );\n  }\n  gallery.innerHTML = '';\n  gallery.insertAdjacentHTML('afterbegin', createMarkup(arrayImages));\n\n  // Fire function that create lightbox after image-cards was rendered\n  addLightbox();\n}\n\n// Check user input\nexport function getUserValue(event) {\n  const value = event.target.value;\n\n  if (value && value.trim().length > 0) {\n    button.classList.remove('is-disable');\n    button.removeAttribute('disabled', '');\n    return value;\n  } else {\n    button.classList.add('is-disable');\n    button.setAttribute('disabled', '');\n  }\n  return;\n}\n\n// Show Loader\nexport function showLoader(status, siblingElement) {\n  const loaderMarkup = '<div class=\"loader\"></div>';\n\n  if (status && !document.querySelector('.loader')) {\n    siblingElement.insertAdjacentHTML('afterend', loaderMarkup);\n  } else {\n    document.querySelector('.loader').remove();\n  }\n}\n\n// Show button load-more\nexport function showLoadMoreButton(status) {\n  if (status) {\n    buttonLoadMore.classList.remove('is-hidden');\n  } else {\n    buttonLoadMore.classList.add('is-hidden');\n  }\n}\n","import './js/pixabay-api';\nimport { fetchImageData } from './js/pixabay-api';\nimport './js/render-functions';\nimport {\n  getUserValue,\n  updateUi,\n  showLoader,\n  showLoadMoreButton,\n  showNotification,\n  createMarkup,\n  addLightbox,\n} from './js/render-functions';\n\nconst refs = {\n  searchForm: document.querySelector('.search-bar-form'),\n  searchInput: document.querySelector('#search-bar'),\n  searchButton: document.querySelector('button'),\n  loadMoreButton: document.querySelector('.load-more-button'),\n  galleryList: document.querySelector('.gallery-list'),\n};\n\n// Search params\nlet userSearchRequestValue = '';\nconst searchParams = {\n  pageCounter: 1,\n  per_page: 110,\n};\nlet totalPages = 0;\n\n// Smooth Scroll to the top of the result list\nconst smoothScroll = () => {\n  const imageCard = refs.galleryList.querySelector(\n    '.image-card-details-list-item'\n  );\n  if (imageCard) {\n    window.scrollTo({\n      top: refs.galleryList.offsetTop - 20, // Scroll to the top of the gallery list\n      left: 0,\n      behavior: 'smooth',\n    });\n  }\n\n  console.log(refs.galleryList.offsetTop);\n};\n// Get search query from user input\nrefs.searchInput.addEventListener('input', event => {\n  userSearchRequestValue = getUserValue(event);\n});\n\n// Submit form to fetch data from server and render result\nasync function onSearchFormSubmit(event) {\n  event.preventDefault();\n\n  const form = event.currentTarget;\n  searchParams.pageCounter = 1;\n\n  try {\n    showLoader(true, refs.searchForm);\n\n    const response = await fetchImageData(userSearchRequestValue, searchParams);\n    const images = response.hits;\n    const totalImages = response.totalHits;\n\n    // Get total pages\n    totalPages = Math.ceil(totalImages / searchParams.per_page);\n\n    // Render images, hide loader, and show load more button\n    updateUi(images);\n    showLoader(false, refs.searchForm);\n    showLoadMoreButton(true);\n  } catch (error) {\n    showNotification(error.message);\n    showLoader(false, refs.searchForm);\n  }\n\n  form.reset();\n}\n// Load more images when user click \"load more\" button\nasync function onLoadMoreButtonClick() {\n  showLoader(true, refs.loadMoreButton);\n\n  try {\n    searchParams.pageCounter += 1;\n\n    const response = await fetchImageData(userSearchRequestValue, searchParams);\n    const images = response.hits;\n    refs.galleryList.insertAdjacentHTML('afterbegin', createMarkup(images));\n    // Fire function that create lightbox after image-cards was rendered\n    addLightbox();\n\n    // Hide button when rich end of collection\n    if (searchParams.pageCounter >= totalPages) {\n      showLoadMoreButton(false);\n      loadMoreButton.removeEventListener('click', onLoadMoreButtonClick);\n    }\n\n    // Run smooth scroll function to scroll smooth on top of the list result\n    smoothScroll();\n\n    // Remove loader from DOM\n    showLoader(false, refs.loadMoreButton);\n  } catch (error) {\n    showNotification(error.message);\n  }\n}\n\nrefs.searchForm.addEventListener('submit', onSearchFormSubmit);\nrefs.loadMoreButton.addEventListener('click', onLoadMoreButtonClick);\n"],"names":["axios","fetchImageData","serachRequest","pageCounter","per_page","response","button","buttonLoadMore","gallery","addLightbox","SimpleLightbox","showNotification","msg","iziToast","createMarkup","array","webformatURL","largeImageURL","tags","likes","views","comments","downloads","updateUi","arrayImages","getUserValue","event","value","showLoader","status","siblingElement","loaderMarkup","showLoadMoreButton","refs","userSearchRequestValue","searchParams","totalPages","smoothScroll","onSearchFormSubmit","form","images","totalImages","error","onLoadMoreButtonClick"],"mappings":"owBAEAA,EAAM,SAAS,QAAU,sBAElB,MAAMC,EAAiB,MAC5BC,EACA,CAAE,YAAAC,EAAa,SAAAC,CAAU,IACtB,CAWH,MAAMC,EAAW,MAAML,EAAM,QAAS,CACpC,OAXmB,CACnB,IAAK,qCACL,EAAGE,EACH,KAAMC,EACN,SAAAC,EACA,WAAY,QACZ,YAAa,aACb,WAAY,MAChB,CAIA,CAAG,EAED,GAAIC,EAAS,SAAW,QACtB,MAAM,IAAI,MAAMA,EAAS,IAAI,EAG/B,OAAOA,EAAS,IAClB,ECtBMC,EAAS,SAAS,cAAc,QAAQ,EACxCC,EAAiB,SAAS,cAAc,mBAAmB,EAC3DC,EAAU,SAAS,cAAc,eAAe,EAG/C,SAASC,GAAc,CACX,IAAIC,EAAe,mBAAoB,CACtD,QAAS,GACT,gBAAiB,MACjB,YAAa,OACb,aAAc,MACd,aAAc,IACd,gBAAiB,QACrB,CAAG,EACQ,QAAO,CAClB,CAGO,SAASC,EAAiBC,EAAK,CACpCC,EAAS,SAAS,CAChB,QAAS,IACT,WAAY,OACZ,SAAU,WACV,aAAc,OACd,KAAM,GACN,MAAO,EACX,CAAG,EAEDA,EAAS,MAAM,CACb,QAASD,EACT,MAAO,qBACP,QAAS,IACT,QAAS,mBACT,WAAY,OACZ,SAAU,WACV,gBAAiB,UACjB,aAAc,OACd,iBAAkB,UAClB,MAAO,EACX,CAAG,CACH,CAGO,SAASE,EAAaC,EAAO,CAClC,OAAOA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA,yBACUL,CAAa,uCAAuCD,CAAY,4DAA4DE,CAAI;AAAA;AAAA;AAAA;AAAA,2DAI9FC,CAAK;AAAA;AAAA;AAAA;AAAA,2DAILC,CAAK;AAAA;AAAA;AAAA;AAAA,2DAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,2DAIRC,CAAS;AAAA;AAAA;AAAA;AAAA,gBAM/D,EACA,KAAK,EAAE,CACZ,CAGO,SAASC,EAASC,EAAa,CAChCA,EAAY,QAAU,GACxBb,EACE,0EACN,EAEEH,EAAQ,UAAY,GACpBA,EAAQ,mBAAmB,aAAcM,EAAaU,CAAW,CAAC,EAGlEf,GACF,CAGO,SAASgB,EAAaC,EAAO,CAClC,MAAMC,EAAQD,EAAM,OAAO,MAE3B,GAAIC,GAASA,EAAM,KAAI,EAAG,OAAS,EACjC,OAAArB,EAAO,UAAU,OAAO,YAAY,EACpCA,EAAO,gBAAgB,WAAY,EAAE,EAC9BqB,EAEPrB,EAAO,UAAU,IAAI,YAAY,EACjCA,EAAO,aAAa,WAAY,EAAE,CAGtC,CAGO,SAASsB,EAAWC,EAAQC,EAAgB,CACjD,MAAMC,EAAe,6BAEjBF,GAAU,CAAC,SAAS,cAAc,SAAS,EAC7CC,EAAe,mBAAmB,WAAYC,CAAY,EAE1D,SAAS,cAAc,SAAS,EAAE,OAAM,CAE5C,CAGO,SAASC,EAAmBH,EAAQ,CACrCA,EACFtB,EAAe,UAAU,OAAO,WAAW,EAE3CA,EAAe,UAAU,IAAI,WAAW,CAE5C,CCzHA,MAAM0B,EAAO,CACX,WAAY,SAAS,cAAc,kBAAkB,EACrD,YAAa,SAAS,cAAc,aAAa,EACjD,aAAc,SAAS,cAAc,QAAQ,EAC7C,eAAgB,SAAS,cAAc,mBAAmB,EAC1D,YAAa,SAAS,cAAc,eAAe,CACrD,EAGA,IAAIC,EAAyB,GAC7B,MAAMC,EAAe,CACnB,YAAa,EACb,SAAU,GACZ,EACA,IAAIC,EAAa,EAGjB,MAAMC,EAAe,IAAM,CACPJ,EAAK,YAAY,cACjC,+BACJ,GAEI,OAAO,SAAS,CACd,IAAKA,EAAK,YAAY,UAAY,GAClC,KAAM,EACN,SAAU,QAChB,CAAK,EAGH,QAAQ,IAAIA,EAAK,YAAY,SAAS,CACxC,EAEAA,EAAK,YAAY,iBAAiB,QAASP,GAAS,CAClDQ,EAAyBT,EAAaC,CAAK,CAC7C,CAAC,EAGD,eAAeY,EAAmBZ,EAAO,CACvCA,EAAM,eAAc,EAEpB,MAAMa,EAAOb,EAAM,cACnBS,EAAa,YAAc,EAE3B,GAAI,CACFP,EAAW,GAAMK,EAAK,UAAU,EAEhC,MAAM5B,EAAW,MAAMJ,EAAeiC,EAAwBC,CAAY,EACpEK,EAASnC,EAAS,KAClBoC,EAAcpC,EAAS,UAG7B+B,EAAa,KAAK,KAAKK,EAAcN,EAAa,QAAQ,EAG1DZ,EAASiB,CAAM,EACfZ,EAAW,GAAOK,EAAK,UAAU,EACjCD,EAAmB,EAAI,CACxB,OAAQU,EAAO,CACd/B,EAAiB+B,EAAM,OAAO,EAC9Bd,EAAW,GAAOK,EAAK,UAAU,CAClC,CAEDM,EAAK,MAAK,CACZ,CAEA,eAAeI,GAAwB,CACrCf,EAAW,GAAMK,EAAK,cAAc,EAEpC,GAAI,CACFE,EAAa,aAAe,EAG5B,MAAMK,GADW,MAAMvC,EAAeiC,EAAwBC,CAAY,GAClD,KACxBF,EAAK,YAAY,mBAAmB,aAAcnB,EAAa0B,CAAM,CAAC,EAEtE/B,IAGI0B,EAAa,aAAeC,IAC9BJ,EAAmB,EAAK,EACxB,eAAe,oBAAoB,QAASW,CAAqB,GAInEN,IAGAT,EAAW,GAAOK,EAAK,cAAc,CACtC,OAAQS,EAAO,CACd/B,EAAiB+B,EAAM,OAAO,CAC/B,CACH,CAEAT,EAAK,WAAW,iBAAiB,SAAUK,CAAkB,EAC7DL,EAAK,eAAe,iBAAiB,QAASU,CAAqB"}